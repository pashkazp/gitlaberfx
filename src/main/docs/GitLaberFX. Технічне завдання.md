- # GitLaberFX: Технічне завдання (Фінальна версія)

  Цей документ описує фінальні технічні та функціональні вимоги до десктопного додатку GitLaberFX, відображаючи його поточний стан після впровадження функціоналу архівації та фільтрації.
- ## 1. Загальна інформація
- ### 1.1 Назва проєкту

  GitLab Branch Manager (GitLaberFX)
- ### 1.2 Мета проєкту

  Розробка надійного та ефективного десктопного додатку для автоматизованого управління гілками в GitLab, що спрощує підтримку порядку в репозиторіях шляхом масового видалення або архівації застарілих гілок.
- ### 1.3 Цільова платформа
- **Технології:** Java 17, JavaFX, Maven.
- **ОС:** Windows, Linux, macOS.
- ## 2. Функціональні вимоги
- ### 2.1 Управління проєктами
- Динамічне завантаження списку проєктів, доступних користувачеві.
- Робота з одним активним проєктом одночасно.
- ### 2.2 Аутентифікація
- **Єдиний метод аутентифікації:** через персональний **API Token** GitLab.
- Надійна перевірка з'єднання, що валідує як URL-адресу, так і API-ключ шляхом тестового запиту до API.
- ### 2.3 Робота з гілками
- Отримання та відображення повного списку гілок для обраного проєкту.
- Можливість обрати **цільову гілку** для аналізу змердженості.
- **Асинхронна перевірка статусу змердженості** гілок відносно цільової шляхом перевірки наявності останнього коміту вихідної гілки в історії цільової гілки.
- **Фільтрація за маскою (RegExp):** Надання можливості масово вибирати або знімати вибір з гілок за допомогою регулярних виразів. Панель фільтрації доступна на головному вікні та у вікні підтвердження.
- **Фільтрація за датою:** Можливість фільтрувати гілки на основі дати останнього коміту, використовуючи критерії "до" та "після". Інтуїтивний інтерфейс для вибору діапазону дат.
- ### 2.4 Інтерфейс та взаємодія
- **Декларативне керування станом кнопок:** кнопки операцій активні лише тоді, коли відповідна дія є логічно можливою.
- **Динамічна зміна локалі:** миттєве перемикання мови інтерфейсу (українська/англійська) без перезавантаження даних з GitLab.
- **Локальне оновлення UI:** після операцій видалення/архівації інтерфейс (таблиця, випадаючі списки) оновлюється локально, без повторних запитів до сервера, зберігаючи контекст користувача.
- ### 2.5 Операції з гілками
- **Загальний процес:** Усі операції видалення/архівації ініціюються через відповідні кнопки, які готують попередній список гілок та відкривають єдине вікно підтвердження.
- **Вікно підтвердження:**
    - Дозволяє користувачеві фінально скоригувати список гілок для операції.
    - Надає вибір між двома режимами:
        - **Безповоротне видалення:** остаточно видаляє гілку з репозиторію.
        - **Архівація:** перейменовує гілку шляхом додавання конфігурованого префіксу (напр., archive/), зберігаючи її історію.
- **Підтримувані операції:**
    - Обробка обраних вручну гілок.
    - Обробка змерджених гілок, старіших за вказану дату.
    - Обробка незмерджених гілок, старіших за вказану дату.
- ## 3. Технічні вимоги
- ### 3.1 Архітектура
- **Патерн:** Гібридний підхід **MVC/MVVM**.
- **UIStateModel:** Централізована модель стану UI, що використовує ObservableList з **екстрактором (Extractor)** для відстеження змін властивостей nameProperty, selectedProperty та mergedIntoTargetProperty.
- **BranchModel:** Містить поле originalName для надійної ідентифікації, поле lastCommitSha для зберігання SHA останнього коміту гілки та конструктор копіювання для ізоляції стану.
- **FilterPanelController:** Реалізований як незалежний, повторно використовуваний UI-компонент.
- **GitLabService.archiveBranch:** Реалізує **атомарну операцію** архівації з механізмом відкату у разі збою.
- **Асинхронність:** Усі довготривалі операції виконуються у фонових потоках за допомогою ExecutorService, налаштованого на створення **потоків-демонів** для гарантованого завершення роботи додатку.
- ### 3.2 Збереження налаштувань
- **Формат:** Файл властивостей (.properties).
- **Локація:** ~/.config/gitlaberfx/config.properties.
- **Зміст:** URL GitLab, API-ключ, обрана локаль, префікс архіву (archivePrefix).
- ### 3.3 Логування
- **Фреймворк:** SLF4J + Logback.
- **Конфігурація:** Налаштовано вивід у консоль та ротацію файлів.
- ### 3.4 API
- Використовуються стандартні ендпоінти GitLab REST API v4. Побудова URL-адрес здійснюється за допомогою HttpUrl.Builder для коректного кодування параметрів.
- ## 4. Нефункціональні вимоги
- ### 4.1 Продуктивність
- UI залишається повністю відгукливим під час виконання всіх фонових операцій.
- Оновлення стану після операцій відбувається миттєво та локально.
- ### 4.2 Надійність
- **Валідація конфігурації:** програма не виконує мережевих запитів, якщо конфігурація відсутня або некоректна.
- **Розширена обробка помилок:** 
    - Користувач отримує зрозумілі повідомлення про помилки.
    - У разі масових операцій, помилки збираються і відображаються у вигляді єдиного звіту.
    - Детальне логування операцій та помилок разом з SHA коміту гілки для покращення відстежуваності та спрощення діагностики проблем.
    - Автоматичні механізми відкату для невдалих операцій, що запобігають частковим змінам стану.
- **Атомарність операцій:** 
    - Гарантується відсутність "напів-заархівованих" гілок у разі збою.
    - Система автоматично відкочує зміни, якщо частина операції не вдалася.
